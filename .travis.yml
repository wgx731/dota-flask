language: python
env:
    - DATABASE_URL=postgresql://localhost/travis_ci_test
services:
    - postgresql
branches:
    only: master
python:
    - '3.6'
install:
    - pip install -r requirements-travis.txt
before_script:
    - psql -c 'create database travis_ci_test;' -U postgres
    - python create_db_only.py
script:
    - coverage run --source=app tests.py
after_success:
    - coverage report
deploy:
  provider: heroku
  api_key:
    secure: qwwklI7POqGjTlfvRCxL1tJOR8m9cyd+AmlOm8cF1JtoH/ZsZP7psHEoYCIgr6U5ax54Ufb/WABz30VdpMa8gzHDZRB98rLF7DiqP8S2AQ41fvMWLYG4A5uAXDYZ2Zoop5pAje0qcairb+Uv1tTl92M7mQVCc6bjEeCcstZd16TPrJ9BARSIfWN/UDCSksi8Ofvt/XwjOoiP8016sRCwjnG+RbymSXUeMUDVlyjRaDcyGu2rFwvZG2RCsvFhU3y7qtYZyGfV80ucL0dnr5EAaf1FwGXRjNcoJiMG82ys0C3QVWz3D48FsVKl6rQd07y48Q4H3UNa96FxKP0XdL9C8PGFWHYeg/YkhoJErVeF8rPS+CF4BwmUHHGoaD5GcVVy9D5FF+e2hIbqI+j5TXAlHJdu+OlAnbvNE2gs82atVFchu9YjlO3ciRQd6jLtJFoqYSJE7YJAduuyw2U6c7wrpsYlB/oZyBL80pFQmW8rDmZLpDhcunj7sMqVX8nNNQb4nHzUb8gs4L+zKK+PBJgzWISKWjnSGTwpy19MzRBxoWC0k+Ywcoj+qgSOcFEYzD5PFZVeKiEmmv32DTTsgu+qalxyk7icrqI+DauVpM48E8e+TXRdiwYYy0Jk2zyRUpaIXtm52sZkqnzJ2O43SK9edQoGGty0cOiN1++7Yz3vwjw=
  app: dota-flask
  on:
    repo: wgx731/dota-flask
    branch: master